{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Импортируем библиотеку Axios\nimport axios from 'axios';\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nlet currentPage = 1; // Инициализация текущей страницы\nlet isLastPage = false;\nlet searchQuery;\nconst itemsPerPage = 40; // Количество изображений на странице\nconst form = document.querySelector('form');\nconst searchInput = document.getElementById('searchInput');\nconst galleryContainer = document.getElementById('gallery');\nconst loader = document.getElementById('loader');\nconst loadMoreButton = document.getElementById('loadMore');\n\nform.addEventListener('submit', async function (event) {\n  event.preventDefault();\n  currentPage = 1;\n  galleryContainer.innerHTML = '';\n  loader.classList.remove('hide')\n  loadMoreButton.style.display = 'none';\n  const apiKey = '41459044-8203682bce4ef2c3a7a872845';\n  searchQuery = searchInput.value.trim();  // Отримуємо значення з текстового поля та видаляємо зайві пробіли\n\n  // Перевіряємо, чи введений пошуковий запит\n  if (searchQuery === \"\") {\n    loader.classList.add('hide');\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search query.',\n      position: 'topRight',\n    });\n    return;\n  }\n\n    const imageType = 'photo'; // Значення параметра image_type\n    const orientation = 'horizontal'; // Значення параметра orientation\n    const safeSearch = true; // Значення параметра safesearch\n    const apiUrl = `https://pixabay.com/api/?key=${apiKey}&q=${searchQuery}&image_type=${imageType}&orientation=${orientation}&safesearch=${safeSearch}&page=${currentPage}&per_page=${itemsPerPage}`;\n    try {\n      const response = await axios.get(apiUrl); // Использование Axios для HTTP-запроса\n      const images = response.data.hits;\n\n      if (images.length > 0) {\n        const imagesMarkup = createMarkup(images);\n        loader.classList.add('hide')\n\n\n        galleryContainer.insertAdjacentHTML('beforeend', imagesMarkup);\n\n        const lightbox = new SimpleLightbox('.image-card a');\n\n        if (images.length === itemsPerPage) {\n          loadMoreButton.style.display = 'block';\n          // loader.style.display = 'none';\n        } else {\n          loadMoreButton.style.display = 'none';\n          iziToast.info({\n            message: 'We are sorry, but you reached the end of search results.',\n            position: 'topRight',\n          });\n\n          // loader.classList.remove('none');\n        }\n\n        // Додаємо обробник подій на кнопку \"Load more...\"\n        loadMoreButton.addEventListener('click', async function (event) {\n          currentPage++;\n          await loadMoreImages();\n        });\n      } else {\n        loadMoreButton.style.display = 'none';\n      }\n    } catch (error) {\n      console.error(\"Помилка при виконанні запиту:\", error);\n    } finally {\n      // loader.classList.remove('visible');\n      form.reset();\n    }\n});\n\nfunction createMarkup(imgArr) {\n  return imgArr.map(({ webformatURL, tags, likes, views, comments, downloads }) => `\n    <div class=\"image-card\">\n      <a href=\"${webformatURL}\" class=\"lightbox-trigger\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\">\n      </a>\n      <div class=\"image-details\">\n        <p><strong>Likes:</strong> ${likes}</p>\n        <p><strong>Views:</strong> ${views}</p>\n        <p><strong>Comments:</strong> ${comments}</p>\n        <p><strong>Downloads:</strong> ${downloads}</p>\n      </div>\n    </div>\n  `).join('');\n}\n\nasync function loadMoreImages() {\n  const apiKey = '41459044-8203682bce4ef2c3a7a872845';\n  const imageType = 'photo';\n  const orientation = 'horizontal';\n  const safeSearch = true;\n  const apiUrl = `https://pixabay.com/api/?key=${apiKey}&q=${searchQuery}&image_type=${imageType}&orientation=${orientation}&safesearch=${safeSearch}&page=${currentPage}&per_page=${itemsPerPage}`;\n  try {\n    loader.classList.remove('hide')\n    loadMoreButton.style.display = 'none';\n    const response = await axios.get(apiUrl);\n    const images = response.data.hits;\n\n    if (images.length > 0) {\n      const imagesMarkup = createMarkup(images);\n      galleryContainer.insertAdjacentHTML('beforeend', imagesMarkup);\n      galleryContainer.insertAdjacentHTML('beforeend', imagesMarkup);\n      const { height: cardHeight } = document.querySelector(\".gallery\").firstElementChild.getBoundingClientRect();\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: \"smooth\",\n      })\n      const lightbox = new SimpleLightbox('.image-card a');\n\n      const totalPages = Math.ceil(response.data.totalHits / itemsPerPage);\n\n      if (currentPage >= totalPages) {\n        loadMoreButton.style.display = 'none';\n        isLastPage = true;\n        loader.classList.add('hide')\n\n        iziToast.info({\n          message: 'We are sorry, but you reached the end of search results.',\n          position: 'topRight',\n        });\n      } else {\n        loadMoreButton.style.display = 'block';\n      }\n\n      // Вызываем метод refresh() на экземпляре SimpleLightbox\n      lightbox.refresh();\n    } else {\n      loadMoreButton.style.display = 'none';\n    }\n  } catch (error) {\n    console.error(\"Помилка при виконанні запиту:\", error);\n  } finally {\n    loader.classList.add('hide')\n  }\n}\n\n"],"names":["currentPage","isLastPage","searchQuery","itemsPerPage","form","searchInput","galleryContainer","loader","loadMoreButton","event","apiKey","iziToast","apiUrl","images","axios","imagesMarkup","createMarkup","lightbox","SimpleLightbox","loadMoreImages","error","imgArr","webformatURL","tags","likes","views","comments","downloads","response","cardHeight","totalPages"],"mappings":"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"}