{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Импортируем библиотеку Axios\nimport axios from 'axios';\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nlet currentPage = 1; // Инициализация текущей страницы\nlet isLastPage = false;\nconst itemsPerPage = 40; // Количество изображений на странице\nconst form = document.querySelector('form');\nconst searchInput = document.getElementById('searchInput');\nconst galleryContainer = document.getElementById('gallery');\nconst loader = document.getElementById('loader');\nconst loadMoreButton = document.getElementById('loadMore');\n\nform.addEventListener('submit', async function (event) {\n  event.preventDefault();\n  galleryContainer.innerHTML = '';\n  loader.classList.remove('hide')\n  loadMoreButton.style.display = 'none';\n\n  const apiKey = '41459044-8203682bce4ef2c3a7a872845';\n  const searchQuery = searchInput.value.trim();  // Отримуємо значення з текстового поля та видаляємо зайві пробіли\n\n  // Перевіряємо, чи введений пошуковий запит\n  if (searchQuery !== \"\") {\n    const imageType = 'photo'; // Значення параметра image_type\n    const orientation = 'horizontal'; // Значення параметра orientation\n    const safeSearch = true; // Значення параметра safesearch\n    const apiUrl = `https://pixabay.com/api/?key=${apiKey}&q=${searchQuery}&image_type=${imageType}&orientation=${orientation}&safesearch=${safeSearch}&page=${currentPage}&per_page=${itemsPerPage}`;\n    try {\n      const response = await axios.get(apiUrl); // Использование Axios для HTTP-запроса\n      const images = response.data.hits;\n\n      if (images.length > 0) {\n        const imagesMarkup = createMarkup(images);\n        loader.classList.add('hide')\n\n\n        // Перевіряємо, чи це перша сторінка, і відповідно вставляємо HTML або додаємо до існуючого\n        galleryContainer.innerHTML = currentPage === 1 ? imagesMarkup : galleryContainer.innerHTML + imagesMarkup;\n\n        const lightbox = new SimpleLightbox('.image-card a');\n\n        if (images.length === itemsPerPage) {\n          loadMoreButton.style.display = 'block';\n          // loader.style.display = 'none';\n        } else {\n          loadMoreButton.style.display = 'none';\n          // loader.classList.remove('none');\n        }\n\n        // Додаємо обробник подій на кнопку \"Load more...\"\n        loadMoreButton.addEventListener('click', async function (event) {\n          currentPage++;\n          await loadMoreImages();\n          // loader.classList.remove('visible');\n        });\n      } else {\n        loadMoreButton.style.display = 'none';\n      }\n    } catch (error) {\n      console.error(\"Помилка при виконанні запиту:\", error);\n    } finally {\n      // loader.classList.remove('visible');\n      form.reset();\n    }\n  } else {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search query.',\n      position: 'topRight',\n    });\n  }\n});\n\nfunction createMarkup(imgArr) {\n  return imgArr.map(({ webformatURL, tags, likes, views, comments, downloads }) => `\n    <div class=\"image-card\">\n      <a href=\"${webformatURL}\" class=\"lightbox-trigger\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\">\n      </a>\n      <div class=\"image-details\">\n        <p><strong>Likes:</strong> ${likes}</p>\n        <p><strong>Views:</strong> ${views}</p>\n        <p><strong>Comments:</strong> ${comments}</p>\n        <p><strong>Downloads:</strong> ${downloads}</p>\n      </div>\n    </div>\n  `).join('');\n}\n\nasync function loadMoreImages() {\n  const apiKey = '41459044-8203682bce4ef2c3a7a872845';\n  const searchQuery = searchInput.value.trim();\n  const imageType = 'photo';\n  const orientation = 'horizontal';\n  const safeSearch = true;\n  const apiUrl = `https://pixabay.com/api/?key=${apiKey}&q=${searchQuery}&image_type=${imageType}&orientation=${orientation}&safesearch=${safeSearch}&page=${currentPage}&per_page=${itemsPerPage}`;\n\n  try {\n    const response = await axios.get(apiUrl);\n    const images = response.data.hits;\n\n    if (images.length > 0) {\n      const imagesMarkup = createMarkup(images);\n      galleryContainer.innerHTML += imagesMarkup;\n      const lightbox = new SimpleLightbox('.image-card a');\n\n      // Округляем вверх значение totalHits / perPage и сверяем с номером страницы\n      const totalPages = Math.ceil(response.data.totalHits / itemsPerPage);\n\n      if (currentPage >= totalPages) {\n        loadMoreButton.style.display = 'none';\n        isLastPage = true;\n\n        iziToast.info({\n          message: 'We are sorry, but you reached the end of search results.',\n          position: 'topRight',\n        });\n      } else {\n        loadMoreButton.style.display = 'block';\n      }\n\n      // Вызываем метод refresh() на экземпляре SimpleLightbox\n      lightbox.refresh();\n    } else {\n      loadMoreButton.style.display = 'none';\n    }\n  } catch (error) {\n    console.error(\"Помилка при виконанні запиту:\", error);\n  } finally {\n    // loader.classList.remove('visible');\n  }\n}\n\n"],"names":["currentPage","isLastPage","itemsPerPage","form","searchInput","galleryContainer","loader","loadMoreButton","event","apiKey","searchQuery","apiUrl","images","axios","imagesMarkup","createMarkup","lightbox","SimpleLightbox","loadMoreImages","error","iziToast","imgArr","webformatURL","tags","likes","views","comments","downloads","response","totalPages"],"mappings":"owBAWA,IAAIA,EAAc,EACdC,EAAa,GACjB,MAAMC,EAAe,GACfC,EAAO,SAAS,cAAc,MAAM,EACpCC,EAAc,SAAS,eAAe,aAAa,EACnDC,EAAmB,SAAS,eAAe,SAAS,EACpDC,EAAS,SAAS,eAAe,QAAQ,EACzCC,EAAiB,SAAS,eAAe,UAAU,EAEzDJ,EAAK,iBAAiB,SAAU,eAAgBK,EAAO,CACrDA,EAAM,eAAc,EACpBH,EAAiB,UAAY,GAC7BC,EAAO,UAAU,OAAO,MAAM,EAC9BC,EAAe,MAAM,QAAU,OAE/B,MAAME,EAAS,qCACTC,EAAcN,EAAY,MAAM,KAAI,EAG1C,GAAIM,IAAgB,GAAI,CAItB,MAAMC,EAAS,gCAAgCF,OAAYC,wDAA6E,WAAmBV,cAAwBE,IACnL,GAAI,CAEF,MAAMU,GADW,MAAMC,EAAM,IAAIF,CAAM,GACf,KAAK,KAE7B,GAAIC,EAAO,OAAS,EAAG,CACrB,MAAME,EAAeC,EAAaH,CAAM,EACxCN,EAAO,UAAU,IAAI,MAAM,EAI3BD,EAAiB,UAAYL,IAAgB,EAAIc,EAAeT,EAAiB,UAAYS,EAE7F,MAAME,EAAW,IAAIC,EAAe,eAAe,EAE/CL,EAAO,SAAWV,EACpBK,EAAe,MAAM,QAAU,QAG/BA,EAAe,MAAM,QAAU,OAKjCA,EAAe,iBAAiB,QAAS,eAAgBC,EAAO,CAC9DR,IACA,MAAMkB,EAAc,CAE9B,CAAS,CACT,MACQX,EAAe,MAAM,QAAU,MAElC,OAAQY,EAAP,CACA,QAAQ,MAAM,gCAAiCA,CAAK,CAC1D,QAAc,CAERhB,EAAK,MAAK,CACX,CACL,MACIiB,EAAS,MAAM,CACb,MAAO,QACP,QAAS,+BACT,SAAU,UAChB,CAAK,CAEL,CAAC,EAED,SAASL,EAAaM,EAAQ,CAC5B,OAAOA,EAAO,IAAI,CAAC,CAAE,aAAAC,EAAc,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAAO;AAAA;AAAA,iBAElEL;AAAA,oBACGA,WAAsBC;AAAA;AAAA;AAAA,qCAGLC;AAAA,qCACAC;AAAA,wCACGC;AAAA,yCACCC;AAAA;AAAA;AAAA,GAGtC,EAAE,KAAK,EAAE,CACZ,CAEA,eAAeT,GAAiB,CAC9B,MAAMT,EAAS,qCACTC,EAAcN,EAAY,MAAM,KAAI,EAIpCO,EAAS,gCAAgCF,OAAYC,wDADxC,WACwIV,cAAwBE,IAEnL,GAAI,CACF,MAAM0B,EAAW,MAAMf,EAAM,IAAIF,CAAM,EACjCC,EAASgB,EAAS,KAAK,KAE7B,GAAIhB,EAAO,OAAS,EAAG,CACrB,MAAME,EAAeC,EAAaH,CAAM,EACxCP,EAAiB,WAAaS,EAC9B,MAAME,EAAW,IAAIC,EAAe,eAAe,EAG7CY,EAAa,KAAK,KAAKD,EAAS,KAAK,UAAY1B,CAAY,EAE/DF,GAAe6B,GACjBtB,EAAe,MAAM,QAAU,OAC/BN,EAAa,GAEbmB,EAAS,KAAK,CACZ,QAAS,2DACT,SAAU,UACpB,CAAS,GAEDb,EAAe,MAAM,QAAU,QAIjCS,EAAS,QAAO,CACtB,MACMT,EAAe,MAAM,QAAU,MAElC,OAAQY,EAAP,CACA,QAAQ,MAAM,gCAAiCA,CAAK,CACxD,QAAY,CAET,CACH"}